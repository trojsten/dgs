\makeatletter

% Render percent sign with nice font, not ugly Computer modern
    \mathcode`\%="7025
    \DeclareRobustCommand{\%}{\text{\symbol{`\%}}}

% Fixes mathspec bug -- URL numbers are rendered with wrong font
\makeatother

\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}

\floatplacement{figure}{H}

% Fix Pandoc's tightlist problem
\providecommand{\tightlist}{}

\newcommand\invisiblesubsection[1]{%
    \refstepcounter{subsection}%
    \addcontentsline{toc}{subsection}{\protect\numberline{\thesubsection}#1}%
    \subsectionmark{#1}%
}
