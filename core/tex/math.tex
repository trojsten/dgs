\RenewDocumentCommand{\vec}{m}{\mathbf{#1}}
%\RenewDocumentCommand{\vec}{m}{\vv{#1}}

\DeclareMathOperator{\diff}{d\!}
\DeclareMathOperator{\pdiff}{\partial\!}
\DeclareMathOperator{\fdiff}{\Delta\!}
\DeclareMathOperator{\del}{\raisebox{0.06em}{\ensuremath{\vec{\nabla}}}}
\DeclareMathOperator{\Div}{\del\cdot}
\DeclareMathOperator{\Rot}{\del\times}

% \Derivative[order]{what}{by-what}
\NewDocumentCommand{\Derivative}{O{} m m}{%
    \IfNoValueTF{#1}{%
        \frac{\diff#2}{\diff#3}%
    }{%
        \frac{\diff^{\,{#1}}\!{#2}}{\diff{#3}^{#1}}%
    }%
}%

% \DerivativeEmpty[order]{by-what}
\NewDocumentCommand{\DerivativeE}{O{} m}{%
    \IfNoValueTF{#1}{%
        \frac{\diff}{\diff#2}%
    }{%
        \frac{\diff^{\,{#1}}}{\diff{#2}^{\,#1}}%
    }%
}%

% \DerivativeParentheses{what}{by-what}
\NewDocumentCommand{\DerivativeParen}{O{} m m}{%
    \IfNoValueTF{#1}{%
        \frac{\diff}{\diff#3}\left(#2\right)%
    }{%
        \frac{\diff^{#1}}{\diff #3^{#1}}\left(#2\right)%
    }%
}%

% \DerivativeEvaluate[order]{what}{by-what}{where}
% \DerivativeEval[2]{f(x)}{x}{0} is second derivative of f(x) at x = 0
\NewDocumentCommand{\DerivativeEval}{O{} m m m}{%
    \EvalAt{\Derivative[#1]{#2}{#3}}{#3 = #4}%
}%

% \PartialDerivative[order]{what}{by-what}
\NewDocumentCommand{\PDerivative}{O{} m m}{%
    \IfNoValueTF{#1}{%
        \frac{\pdiff#2}{\pdiff#3}%
    }{%
        \frac{\pdiff^{\,{#1}}\!{#2}}{\pdiff{#3}^{#1}}%
    }%
}%

% \PartialDerivativeEmpty[order]{by-what}
\NewDocumentCommand{\PDerivativeE}{O{} m}{%
    \IfNoValueTF{#1}{%
        \frac{\pdiff}{\pdiff#2}%
    }{%
        \frac{\pdiff^{\,{#1}}}{\pdiff{#2}^{\,#1}}%
    }%
}%

% \PartialDerivativeParentheses{what}{by-what}
\NewDocumentCommand{\PDerivativeParen}{O{} m m}{%
    \IfNoValueTF{#1}{%
        \frac{\pdiff}{\pdiff#3}\left(#2\right)%
    }{%
        \frac{\pdiff^{#1}}{\pdiff #3^{#1}}\left(#2\right)%
    }%
}%

% \PartialDerivativeEvaluate[order]{what}{by-what}{where}
% \PartialDerivativeEval[2]{f(x)}{x}{0} is second derivative of f(x) at x = 0
\NewDocumentCommand{\PDerivativeEval}{O{} m m m}{%
    \EvalAt{\PDerivative[#1]{#2}{#3}}{#3 = #4}%
}%

\NewDocumentCommand{\EvalAt}{m m}{\left.#1\right|_{#2}}
\NewDocumentCommand{\Expected}{m}{\left<#1\right>}

\NewDocumentCommand{\Int}{O{} O{} m m}{\kern -0.2em \int\limits_{#1}^{#2} #3\diff#4}
\NewDocumentCommand{\Intx}{O{} O{} m}{\kern -0.2em \int\limits_{#1}^{#2} #3}
\NewDocumentCommand{\OInt}{O{} O{} m m}{\oint\limits_{#1}^{#2}\!#3\diff#4}
\NewDocumentCommand{\IInt}{O{} O{} m m m}{\iint\limits_{#1}^{\quad#2} #3 \diff#4\diff#5}
\NewDocumentCommand{\OIInt}{O{} O{} m m}{\oiint\limits_{#1}^{\quad#2} #3 \diff#4}
\NewDocumentCommand{\IIInt}{O{} O{} m m m m}{\iiint\limits_{#1}^{#2} #3 \diff#4\diff#5\diff#6}

\NewDocumentCommand{\Lim}{m m}{\lim\limits_{#1 \rightarrow #2}}
\NewDocumentCommand{\Exp}{m}{\mathrm{e}^{#1}}
\NewDocumentCommand{\LogTen}{}{\log_{10}}
\NewDocumentCommand{\MustEqual}{}{\stackrel{!}{=}}
\NewDocumentCommand{\DefEqual}{}{\stackrel{\mathrm{def}}{=}}
\NewDocumentCommand{\Implies}{}{\quad\Rightarrow\quad}

\NewDocumentCommand{\Nuclide}{O{} O{} m}{\ce{^{#1}_{#2}#3}}

\NewDocumentCommand{\Sum}{O{} O{} m}{\sum\limits_{#1}^{#2} #3}
\NewDocumentCommand{\Product}{O{} O{} m}{\prod\limits_{#1}^{#2} #3}
\NewDocumentCommand{\Abs}{m}{\left|#1\right|}
\RenewDocumentCommand{\Hat}{m}{#1\kern-0.1em\hat{\phantom{#1}}}

\NewDocumentCommand{\Angle}{}{\text{\AngleSign}}
